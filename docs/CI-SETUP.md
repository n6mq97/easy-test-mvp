# Упрощенный CI Pipeline

## Обзор

Новый CI pipeline упрощен с 160 строк до ~50 строк и использует Docker Compose для запуска всего стека.

## Структура

```
.github/workflows/simple-ci.yml    # Упрощенный CI воркфлоу
docker-compose.ci.yml             # CI-специфичный docker-compose
back/Dockerfile.ci                # Backend Dockerfile для CI
front/Dockerfile.ci               # Frontend Dockerfile для CI
scripts/test-all.sh               # Скрипт для локального тестирования
```

## Сервисы

- `test_postgres` - PostgreSQL для тестов
- `test_backend` - Backend API для тестов  
- `test_frontend` - Frontend для тестирования

## Как работает

### 1. Запуск сервисов
- PostgreSQL с health checks
- Backend с health checks  
- Frontend для тестирования

### 2. Тестирование
- Backend тесты через pytest
- Frontend тесты через vitest
- Frontend линт и сборка

### 3. Очистка
- Автоматическая остановка контейнеров

## Локальное тестирование

```bash
# Запуск упрощенного CI локально
make test-ci-simple

# Или напрямую
./scripts/test-all.sh
```

## Преимущества

✅ **Простота** - один job вместо трех  
✅ **Реальность** - настоящие интеграционные тесты  
✅ **Быстрота** - параллельное выполнение  
✅ **Надежность** - меньше точек отказа  
✅ **Локальность** - легко отлаживать  

## Отличия от старого CI

| Аспект | Старый CI | Новый CI |
|--------|-----------|----------|
| Jobs | 3 отдельных | 1 объединенный |
| Строки кода | ~160 | ~50 |
| Тестирование | Изолированное | Интеграционное |
| Сложность | Высокая | Низкая |
| Отладка | Сложно | Просто |

## Требования

- Docker и Docker Compose
- Доступ к портам 5433, 8001, 3001 (тестовые)
- Node.js 20+ (для локального запуска)
- Python 3.13+ (для локального запуска)

## Порты

| Сервис | Внешний порт | Внутренний порт |
|--------|--------------|-----------------|
| test_postgres | 5433 | 5432 |
| test_backend | 8001 | 8000 |
| test_frontend | 3001 | 3000 |
